# 10 状态模式 事物的状态
策略模式和状态模式是双胞胎,出生时才分开
## 如何实现状态?(办公室隔间对话)
## 状态机101
状态机:
1. 找出所有的状态: 不足25分, 25分以上, 糖果卖完, 售出糖果
2. 通过int值表示状态
3. 可以发生的动作: 投入25分, 退回25分, 转把手, 发糖果
4. 一个状态对应一个动作
## 状态机代码的第一个版本
## 该来的躲不掉......变更请求
A. 代码没有遵守开放-关闭的原则 T
B. 这份代码会让Fortran骄傲 F
C. 设计不符合面向对象 T
D. 状态埋藏在条件语句下,所以并不明显 T
E. 我们还没有把会改变的部分包装起来 T
F: 未来加入的代码可能会导致bug T
## 混乱的状态......
## 定义状态接口和类
## 实现我们的状态类
## 重新改造糖果机
## 定义状态模式
状态模式: 允许对象在内部状态改变时改变它的行为,对象看起来好像修改了它的类
## 状态 VS 策略模式
## 精神检查......
- State改成抽象类,把错误行为移到这里
- dispense()和turnCrank(),turnCrank()返回布尔值,还是抛出异常? 我倾向于抛出异常
- 状态类的问题在于类可能爆炸,逻辑移回糖果机,容易出错
- 对GumballMachine和State使用单例模式,避免重复创建
## 我们差点儿忘了!
状态: 封装基于状态的行为,并将行为委托到当前状态
策略: 将可以互换的行为封装成对象,然后使用委托的方法,决定使用哪一个行为
模板方法: 由子类决定某些步骤,而其他步骤由模板方法完成
## 设计箱内的工具
